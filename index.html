<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tenzor Sailing Club — Календарь мероприятий</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.cdnfonts.com/css/zing-rust-base" rel="stylesheet">
  <link href="https://fonts.cdnfonts.com/css/tt-octosquares" rel="stylesheet">
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background:
        radial-gradient(circle at 20% 50%, rgba(255,255,255,0.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 50%, rgba(255,255,255,0.08) 0%, transparent 50%),
        linear-gradient(135deg, #1e3a8a 0%, #1e40af 25%, #2563eb 50%, #3b82f6 75%, #60a5fa 100%);
      min-height:100vh; color:#0f172a; position:relative; overflow-x:hidden;
    }
    body::before{
      content:''; position:absolute; inset:0;
      background:
        repeating-linear-gradient(0deg, transparent 0px, transparent 100px, rgba(255,255,255,0.08) 100px, rgba(255,255,255,0.08) 101px),
        repeating-linear-gradient(90deg, transparent 0px, transparent 100px, rgba(255,255,255,0.08) 100px, rgba(255,255,255,0.08) 101px);
      pointer-events:none;
    }
    .container{ max-width: 420px; margin:0 auto; padding:20px; position:relative; z-index:1; }
    .header{ text-align:center; margin-bottom:16px; color:#fff; display:flex; flex-direction:column; align-items:center; gap:8px; }
    .logo{ width:162px; height:auto; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3)); animation: wave 3s ease-in-out infinite; }
    h1{ font-family:'Zing Rust Base','Inter',sans-serif; font-weight:800; font-size:24px; letter-spacing:-0.5px; text-shadow:0 2px 4px rgba(0,0,0,0.3); }
    .subtitle{ font-size:14px; opacity:0.9; text-shadow:0 1px 2px rgba(0,0,0,0.2); }
    @keyframes wave { 0%,100%{ transform:translateY(0);} 50%{ transform:translateY(-5px);} }

    /* Month slider */
    .month-slider-wrap{ display:flex; align-items:center; gap:8px; margin-bottom:14px; }
    .nav-btn{
      background: rgba(255,255,255,0.2);
      border:2px solid rgba(255,255,255,0.4);
      color:#fff; width:44px; height:44px; border-radius:12px;
      font-size:20px; font-weight:800; cursor:pointer; transition:.25s; backdrop-filter: blur(8px);
    }
    .nav-btn:disabled{ opacity:.4; cursor:not-allowed; }
    .nav-btn:hover:not(:disabled){ background:rgba(255,255,255,.9); color:#1e3a8a; transform:translateY(-2px); }
    .months{
      flex:1; display:flex; overflow-x:auto; gap:8px; padding-bottom:6px; scroll-snap-type:x mandatory;
    }
    .month-pill{
      scroll-snap-align:center; white-space:nowrap; padding:10px 14px; border-radius:14px;
      background: rgba(255,255,255,0.18);
      border:2px solid rgba(255,255,255,0.4);
      color:#fff; font-family:'TT Octosquares','Inter',sans-serif; font-weight:700; font-size:13px;
      cursor:pointer; transition:.25s; backdrop-filter: blur(8px);
    }
    .month-pill.active, .month-pill:hover{ background:#fff; color:#1e3a8a; transform:translateY(-2px); box-shadow:0 6px 20px rgba(255,255,255,0.3); }

    /* Filters */
    .filters{ display:flex; gap:8px; margin-bottom:16px; overflow-x:auto; padding-bottom:6px; }
    .filter-btn{
      background: rgba(255,255,255,0.2);
      border:2px solid rgba(255,255,255,0.4);
      padding:8px 14px; border-radius:18px; color:#fff;
      font-family:'TT Octosquares','Inter',sans-serif; font-size:12px; font-weight:700;
      cursor:pointer; transition:.25s; white-space:nowrap; backdrop-filter: blur(10px);
    }
    .filter-btn.active, .filter-btn:hover{ background:#fff; color:#1e3a8a; transform:translateY(-2px); box-shadow:0 4px 12px rgba(255,255,255,0.3); }

    .calendar{
      background: rgba(255,255,255,0.95);
      border-radius:20px; padding:18px; backdrop-filter: blur(20px);
      box-shadow:0 20px 40px rgba(0,0,0,0.2); border:2px solid rgba(255,255,255,0.3);
    }
    .calendar-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:14px; }
    .calendar-header h2{
      font-family:'TT Octosquares','Inter',sans-serif; font-size:20px; font-weight:800; color:#1e3a8a;
    }
    .weekdays{ display:grid; grid-template-columns: repeat(7,1fr); gap:5px; margin-bottom:10px; }
    .weekday{ text-align:center; font-family:'TT Octosquares','Inter',sans-serif; font-size:11px; font-weight:700; color:#1e40af; padding:8px 0; }

    .days{ display:grid; grid-template-columns:repeat(7,1fr); gap:5px; }
    .day{
      aspect-ratio:1; display:flex; flex-direction:column; align-items:center; justify-content:center;
      border-radius:12px; cursor:pointer; transition:.25s; position:relative; font-size:14px; font-weight:600; color:#1e3a8a;
    }
    .day.out{ opacity:.35; cursor:default; }
    .day:hover{ background:rgba(59,130,246,0.08); transform:scale(1.04); }
    .day.has-events{ background: linear-gradient(135deg, #2563eb, #1e40af); color:#fff; box-shadow:0 4px 15px rgba(37,99,235,0.35); }
    .day.selected{ background: linear-gradient(135deg, #60a5fa, #3b82f6) !important; color:#fff !important; transform:scale(1.08); box-shadow:0 6px 20px rgba(96,165,250,0.45); }
    .event-indicator{ width:6px; height:6px; background:#fff; border-radius:50%; margin-top:2px; }

    .events-panel{ margin-top:18px; max-height:320px; overflow-y:auto; }
    .event-card{
      background:#fff; border-radius:14px; padding:14px; margin-bottom:12px;
      box-shadow:0 5px 15px rgba(0,0,0,0.08); border-left:4px solid; transition:.25s; text-decoration:none; color:inherit; display:block;
    }
    .event-card:hover{ transform: translateY(-2px); box-shadow:0 10px 25px rgba(0,0,0,0.15); }
    .event-card .title{ font-family:'TT Octosquares','Inter',sans-serif; font-weight:800; font-size:15px; color:#1e3a8a; margin-bottom:4px; }
    .event-card .meta{ font-size:13px; color:#475569; }
    .event-card .tags{ margin-top:6px; display:flex; gap:6px; flex-wrap:wrap; }
    .tag{ font-size:11px; font-weight:700; border-radius:999px; padding:4px 8px; border:1px solid #e2e8f0; color:#1e293b; background:#f8fafc; }

    .register-btn{
      width:100%; background: linear-gradient(135deg, #2563eb, #1e40af); border:none; padding:14px 18px; border-radius:14px;
      color:#fff; font-family:'TT Octosquares','Inter',sans-serif; font-size:15px; font-weight:800; cursor:pointer; transition:.25s;
      text-decoration:none; display:block; text-align:center; margin-top:14px; box-shadow:0 5px 15px rgba(37,99,235,0.3);
    }
    .register-btn:hover{ transform: translateY(-2px); box-shadow:0 8px 25px rgba(37,99,235,0.4); background: linear-gradient(135deg, #3b82f6, #2563eb); }

    /* category colors on left border */
    .kids { border-left-color:#22c55e; }
    .tec { border-left-color:#2563eb; }
    .tic { border-left-color:#0ea5e9; }
    .brics { border-left-color:#ef4444; }
    .intensive { border-left-color:#60a5fa; }
    .ufo { border-left-color:#a855f7; }

    .no-events{ text-align:center; padding:28px 16px; color:#64748b; }
    .no-events-icon{ font-size:44px; margin-bottom:10px; opacity:.5; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <!-- Simple Tenzor mark (inline SVG from previous file trimmed) -->
      <svg class="logo" width="80" height="45" viewBox="0 0 1920 1080" xmlns="http://www.w3.org/2000/svg">
        <defs><style>.st0{fill:#fff;}</style></defs>
        <circle class="st0" cx="40" cy="22" r="16"></circle>
        <rect class="st0" x="64" y="8" width="8" height="28" rx="4"></rect>
        <rect class="st0" x="78" y="14" width="8" height="22" rx="4"></rect>
        <rect class="st0" x="92" y="4" width="8" height="32" rx="4"></rect>
      </svg>
      <h1>Tenzor Sailing Club</h1>
      <div class="subtitle">Календарь мероприятий</div>
    </div>

    <div class="month-slider-wrap">
      <button class="nav-btn" id="prev-month" aria-label="Предыдущий месяц">‹</button>
      <div class="months" id="months"></div>
      <button class="nav-btn" id="next-month" aria-label="Следующий месяц">›</button>
    </div>

    <div class="filters">
      <button class="filter-btn active" data-filter="all">Все</button>
      <button class="filter-btn" data-filter="kids">Дети</button>
      <button class="filter-btn" data-filter="tec">Tenzor Elite Cup</button>
      <button class="filter-btn" data-filter="tic">Tenzor International Cup</button>
      <button class="filter-btn" data-filter="brics">BRICS</button>
      <button class="filter-btn" data-filter="intensive">Интенсив</button>
      <button class="filter-btn" data-filter="ufo">Кубок ЮФО</button>
    </div>

    <div class="calendar">
      <div class="calendar-header">
        <h2 id="current-month-label"></h2>
      </div>

      <div class="weekdays">
        <div class="weekday">Пн</div><div class="weekday">Вт</div><div class="weekday">Ср</div>
        <div class="weekday">Чт</div><div class="weekday">Пт</div><div class="weekday">Сб</div><div class="weekday">Вс</div>
      </div>

      <div class="days" id="days"></div>

      <div class="events-panel" id="events-panel">
        <div class="no-events">
          <div class="no-events-icon">⛵</div>
          <p>Выберите день в календаре, чтобы увидеть события</p>
        </div>
      </div>

      <a class="register-btn" target="_blank" href="https://wa.me/+79299513777">Записаться</a>
    </div>
  </div>

<script>
/** =========================
 *  DATA
 *  ========================= */
// Helper to build Date objects in local time (no TZ surprises)
function d(y,m,day){ return new Date(y, m-1, day); }

// Catalog months (YYYY-MM)
const monthRange = [
  "2025-09", "2025-10", "2025-11", "2025-12",
  "2026-01", "2026-02", "2026-03", "2026-04"
];

// Events database
const EVENTS = [
  // Детские первенства — Геленджик
  { title:"ДЕТИ • Первенство России", place:"Геленджик", start:d(2025,9,26), end:d(2025,10,10), cats:["kids"] },
  { title:"ДЕТИ • Геленджикская регата (начинающие)", place:"Геленджик", start:d(2025,10,25), end:d(2025,11,3), cats:["kids"] },
  { title:"ДЕТИ • Командные гонки Первенства России", place:"Геленджик", start:d(2025,11,4), end:d(2025,11,10), cats:["kids"] },

  // Осень-зима — Tenzor & Турция
  { title:"Tenzor Elite Cup (Сочи) • ФИНАЛ", start:d(2025,11,6), end:d(2025,11,9), cats:["tec"] },
  { title:"Tenzor International Cup Turkiye • 1 этап", start:d(2025,11,19), end:d(2025,11,23), cats:["tic"] },
  { title:"Парусный интенсив с Алексеем Кулаковым (Сочи)", start:d(2025,11,27), end:d(2025,11,30), cats:["intensive"] },

  { title:"Tenzor Elite Cup (Сочи) • 1 этап", start:d(2025,12,4), end:d(2025,12,7), cats:["tec"] },
  { title:"КУБОК ЮФО (Сочи) • 1 этап", start:d(2025,12,11), end:d(2025,12,14), cats:["ufo"] },
  { title:"Tenzor International Cup & BRICS Turkiye • 2 этап", start:d(2025,12,18), end:d(2025,12,21), cats:["tic","brics"] },

  { title:"Tenzor Elite Cup (Сочи) • 2 этап", start:d(2026,1,8), end:d(2026,1,11), cats:["tec"] },
  { title:"Tenzor International Cup Turkiye • 3 этап", start:d(2026,1,15), end:d(2026,1,18), cats:["tic"] },
  { title:"КУБОК ЮФО (Сочи) • 2 этап", start:d(2026,1,22), end:d(2026,1,25), cats:["ufo"] },

  { title:"Tenzor Elite Cup (Сочи) • 3 этап", start:d(2026,2,5), end:d(2026,2,8), cats:["tec"] },
  { title:"КУБОК ЮФО (Сочи) • 3 этап", start:d(2026,2,12), end:d(2026,2,15), cats:["ufo"] },
  { title:"Tenzor International Cup Turkiye • 4 этап", start:d(2026,2,19), end:d(2026,2,22), cats:["tic"] },

  { title:"Tenzor Elite Cup (Сочи) • 4 этап", start:d(2026,3,5), end:d(2026,3,8), cats:["tec"] },
  { title:"КУБОК ЮФО (Сочи) • 4 этап", start:d(2026,3,12), end:d(2026,3,15), cats:["ufo"] },
  { title:"Tenzor International Cup Turkiye • 5 этап", start:d(2026,3,19), end:d(2026,3,22), cats:["tic"] },

  { title:"Tenzor Elite Cup (Сочи) • 5 этап — ФИНАЛ", start:d(2026,4,2), end:d(2026,4,5), cats:["tec"] },
  { title:"Tenzor International Cup Turkiye • 5 этап — ФИНАЛ", start:d(2026,4,9), end:d(2026,4,12), cats:["tic"] },
  { title:"КУБОК ЮФО (Сочи) • 5 этап — ФИНАЛ", start:d(2026,4,16), end:d(2026,4,19), cats:["ufo"] },
];

const CATEGORY_LABEL = {
  kids: "Дети",
  tec: "Tenzor Elite Cup",
  tic: "Tenzor International Cup",
  brics: "BRICS",
  intensive: "Интенсив",
  ufo: "Кубок ЮФО"
};

/** =========================
 *  STATE
 *  ========================= */
let currentMonthIndex = 0; // start at first month of range
let currentFilter = "all";
let selectedDay = null;

/** =========================
 *  HELPERS
 *  ========================= */
function fmtMonthLabel(ym){
  const [y,m]=ym.split("-").map(Number);
  const dt = new Date(y, m-1, 1);
  return dt.toLocaleDateString("ru-RU", { month:"long", year:"numeric" });
}
function ymKey(dateObj){
  const y = dateObj.getFullYear();
  const m = String(dateObj.getMonth()+1).padStart(2,"0");
  return `${y}-${m}`;
}
function daysInMonth(y, m){ return new Date(y, m, 0).getDate(); } // m is 1..12
function getMonthEvents(ym){
  // Return events that overlap the month
  const [y,m] = ym.split("-").map(Number);
  const start = new Date(y, m-1, 1);
  const end = new Date(y, m, 0); // last day of month
  return EVENTS.filter(ev => ev.end >= start && ev.start <= end);
}
function rangeDays(start, end){
  const out=[]; const d = new Date(start);
  while (d <= end){
    out.push(new Date(d));
    d.setDate(d.getDate()+1);
  }
  return out;
}

/** =========================
 *  RENDER
 *  ========================= */
function renderMonthPills(){
  const wrap = document.getElementById("months");
  wrap.innerHTML = "";
  monthRange.forEach((ym, idx) => {
    const btn = document.createElement("button");
    btn.className = "month-pill" + (idx===currentMonthIndex ? " active" : "");
    btn.textContent = fmtMonthLabel(ym);
    btn.addEventListener("click", ()=>{ currentMonthIndex = idx; selectedDay=null; renderAll(); });
    wrap.appendChild(btn);
  });
  document.getElementById("prev-month").disabled = currentMonthIndex===0;
  document.getElementById("next-month").disabled = currentMonthIndex===monthRange.length-1;
}

function renderCalendar(){
  const ym = monthRange[currentMonthIndex];
  const label = document.getElementById("current-month-label");
  label.textContent = fmtMonthLabel(ym);

  const [y,m] = ym.split("-").map(Number);
  const firstDay = new Date(y, m-1, 1);
  const days = daysInMonth(y, m);
  let startWeekday = firstDay.getDay(); // 0=Sun..6=Sat
  // We want Monday-first grid: convert 0..6 so that Mon=0..Sun=6
  startWeekday = (startWeekday + 6) % 7;

  const monthEvents = getMonthEvents(ym);
  const mapDayToEvents = {};
  monthEvents.forEach(ev => {
    const s = new Date(Math.max(ev.start, new Date(y, m-1, 1)));
    const e = new Date(Math.min(ev.end, new Date(y, m-1, days)));
    rangeDays(s, e).forEach(dy => {
      const key = dy.getDate();
      (mapDayToEvents[key] ||= []).push(ev);
    });
  });

  const grid = document.getElementById("days");
  grid.innerHTML = "";

  // Lead-in cells from prev month
  for(let i=0;i<startWeekday;i++){
    const cell = document.createElement("div");
    cell.className = "day out";
    grid.appendChild(cell);
  }
  // Month days
  for(let dnum=1; dnum<=days; dnum++){
    const cell = document.createElement("div");
    cell.className = "day";
    cell.textContent = dnum;
    if (mapDayToEvents[dnum]){
      // Filter awareness for the dot & background
      const hasFiltered = currentFilter==="all" ? true : mapDayToEvents[dnum].some(e => e.cats.includes(currentFilter));
      if (hasFiltered){
        cell.classList.add("has-events");
        const dot = document.createElement("div");
        dot.className = "event-indicator";
        cell.appendChild(dot);
      }
    }
    cell.addEventListener("click", ()=>{ selectedDay = dnum; renderEvents(); document.querySelectorAll('.day').forEach(x=>x.classList.remove('selected')); cell.classList.add('selected'); });
    grid.appendChild(cell);
  }
}

function renderEvents(){
  const panel = document.getElementById("events-panel");
  const ym = monthRange[currentMonthIndex];
  const [y,m] = ym.split("-").map(Number);
  const monthEvents = getMonthEvents(ym);

  if (!selectedDay){
    panel.innerHTML = `<div class="no-events"><div class="no-events-icon">⛵</div><p>Выберите день в календаре, чтобы увидеть события</p></div>`;
    return;
  }
  const dayDate = new Date(y, m-1, selectedDay);
  const list = monthEvents.filter(ev => ev.start <= dayDate && ev.end >= dayDate);
  const filtered = currentFilter==="all" ? list : list.filter(ev => ev.cats.includes(currentFilter));

    const regBtn = document.querySelector(".register-btn");
  if (filtered.length > 0) {
    regBtn.href = filtered.some(ev => ev.cats && ev.cats.includes("kids"))
      ? "https://t.me/tenzorsailingacademykids"
      : "https://wa.me/+79299513777";
  } else {
    regBtn.href = "https://wa.me/+79299513777";
  }

if (filtered.length===0){
    panel.innerHTML = `<div class="no-events"><div class="no-events-icon">🔍</div><p>Событий выбранной категории нет на ${selectedDay} ${fmtMonthLabel(ym)}</p></div>`;
    return;
  }

  const html = filtered.map(ev => {
    const catsHtml = ev.cats.map(c=>`<span class="tag">${CATEGORY_LABEL[c]||c}</span>`).join("");
    const cls = ev.cats[0] || "tec";
    const dateRange = (ev.start.toLocaleDateString("ru-RU",{day:"2-digit", month:"short"})
      + " – " + ev.end.toLocaleDateString("ru-RU",{day:"2-digit", month:"short", year:"numeric"})).replace(/\./g,"");
    const meta = ev.place ? `${dateRange} • ${ev.place}` : dateRange;
    const link = ev.cats.includes("kids") ? "https://t.me/tenzorsailingacademykids" : "https://wa.me/+79299513777";
    return `<a class="event-card ${cls}" href="${link}" target="_blank">
      <div class="title">${ev.title}</div>
      <div class="meta">${meta}</div>
      <div class="tags">${catsHtml}</div>
    </a>`;
  }).join("");
  panel.innerHTML = html;
}

function renderFilters(){
  document.querySelectorAll(".filter-btn").forEach(btn => {
    btn.classList.toggle("active", btn.dataset.filter===currentFilter || (btn.dataset.filter==="all" && currentFilter==="all"));
  });
}

function renderAll(){
  renderMonthPills();
  renderFilters();
  renderCalendar();
  renderEvents();
}

/** =========================
 *  INIT
 *  ========================= */
document.addEventListener("DOMContentLoaded", () => {
  // Init month pills
  renderAll();

  // Nav buttons
  document.getElementById("prev-month").addEventListener("click", ()=>{
    if (currentMonthIndex>0){ currentMonthIndex--; selectedDay=null; renderAll(); }
  });
  document.getElementById("next-month").addEventListener("click", ()=>{
    if (currentMonthIndex<monthRange.length-1){ currentMonthIndex++; selectedDay=null; renderAll(); }
  });

  // Filters
  document.querySelectorAll(".filter-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      currentFilter = btn.dataset.filter;
      selectedDay = selectedDay; // keep selected day
      renderAll();
    });
  });
});
</script>
</body>
</html>
